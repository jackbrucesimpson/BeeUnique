# BeeUnique
Program to track bees with unique tags.

## Running the Programs
Execution scripts are located in the `bin` directory. Instructions for how to modify the variables in them for processing your own data are included below.

You can execute the scripts by running the `bash` command followed by the script name. For example, if you want to run the `track.sh` script described below, you can execute it by running `bash track.sh` in the terminal.

### setup.sh
The purpose of this script is to set some default variables for each experiment. You do not have to run this file, as these variables will be imported into the other scripts automatically.

|Variable|Description|
|:-:|:-|
|OUTPUT_DIRECTORY|Directory path where you want the program output to be written.|
|EXPERIMENT_NAME|Name of your experiment's dataset. Must not have spaces as a directory will be created with this name in the output directory.|

### track.sh
Tracking program that processes videos and creates csvs with tracking data and background images for each video.

|Variable|Description|
|:-:|:-|
|VIDEO_DIRECTORY|Set to the directory video files are stored in.|
|TRAINING| Can set to 1 (True) or 0 (False). If set to training mode, the program will terminate after processing 2 mins footage from each video. Does not attempt to classify tags - merely sets them to

### overlay.sh
Overlays tracking and tag pattern classifications onto a video. You can close the window that appears by pressing 'q'.

|Variable|Description|
| :-: |:-|
|FILENAME_PATH|Set to the path of the video you want to see.|
|COORD_FILE_PATH|Set to the path of the csv or json file that was output by the tracking program for that video.|
|CREATE_VIDEO|1 (True) or 0 (False). Outputs a 4K video of overlaid footage but slows down the program.|
|OUTPUT_VIDEO_FILE|Set to the path and filename of the video you wish to output.|

### process_paths.sh


### combine_bg.sh
Combines the background images generated by each hour-long video into a single average image for each day. Outputs to `daily_background` directory.

### reclassify_csv.sh
Will go over all the csvs that were generated and reclassify all the tags in the file.

### output_tags.sh
Will go over all the csvs that were generated and create the tag images. Images will be grouped by bee path and all the bee paths from the same video will be stored in the same directory. Images that are extremely similar will not be written out to avoid duplication.

|Variable|Description|
|:-:|:-|
|||

## Setup

### Dependencies
- Requires Linux/MacOS
- Python 2
- OpenCV 2

### Ubuntu Installation

#### System packages
`sudo apt-get install libopencv-dev python-opencv python-pip exfat-fuse`

#### Python libraries
`pip2 install numpy matplotlib pandas scipy sklearn cython h5py`

#### Machine Learning Libraries

If you want to set these libraries up to run on the GPU (optional), please follow the steps [here](https://gist.github.com/jackbrucesimpson/854b76ec1a3005af3377f7b22fda1f13) rather than running the command below.

`pip2 install tensorflow keras`

#### Building

Compile the tracking library in the `bin` directory.

`bash build.sh`
